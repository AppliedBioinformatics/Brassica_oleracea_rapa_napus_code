)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free',
labeller = (Genome = mylabel))
p
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', 'B. napus (with synthetics)',"B. napus (no synthetics)")),
y = Count,
colour = Status,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', 'B. napus\n(with synthetics)',"B. napus (no synthetics)")),
y = Count,
colour = Status,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with synthetics)", "B. napus (no synthetics)", "B. rapa", "B. napus\n(with synthetics)", "B. napus (no synthetics)",
"B. oleracea", "B. napus\n(with synthetics)", "B. napus (no synthetics)", "B. oleracea", "B. napus\n(with synthetics)", "B. napus (no synthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(6457, 16844, 10447, 33169, 32145, 38542, 8093, 28464, 18233, 38916, 41938, 52169)
)
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', 'B. napus\n(with synthetics)',"B. napus (no synthetics)")),
y = Count,
colour = Status,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)",
"B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(6457, 16844, 10447, 33169, 32145, 38542, 8093, 28464, 18233, 38916, 41938, 52169)
)
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', 'B. napus\n(with synthetics)',"B. napus\n(no synthetics)")),
y = Count,
colour = Status,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Count,
colour = Status,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)",
"B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(6457, 16844, 10447, 33169, 32145, 38542, 8093, 28464, 18233, 38916, 41938, 52169)
)
core_vs_variable
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)",
"B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(21729, 16844, 10447, 42089, 32145, 38542, 14667, 28464, 18233, 50973, 41938, 52169)
)
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Count,
colour = Status,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
core_vs_variable %>% group_by(Species, Genome) %>% summarise(total = sum(Count))
library(tidyverse)
core_vs_variable %>% group_by(Species, Genome) %>% summarise(total = sum(Count))
core_vs_variable %>% group_by(Species) %>% summarise(total = sum(Count))
library(ggplot2)
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)",
"B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(21729, 16844, 10447, 42089, 32145, 38542, 14667, 28464, 18233, 50973, 41938, 52169)
)
core_vs_variable
save_plot(p, filename = 'Core_Variable_Genes_Per_A_C_Genome.png', base_aspect_ratio = 1.3, base_height = 5)
library(cowplot)
theme_set(theme_light())
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Count,
colour = Status,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Count,
colour = Status,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
geom_bar() +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
?geom_bar
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Count,
colour = Status,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
geom_col() +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Count,
colour = Status,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
geom_col(fill=Status) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Count,
colour = Status,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
geom_point(size = 3) +
geom_line() +
geom_col(aes(fill=Status)) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Count,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
#geom_point(size = 3) +
#geom_line() +
geom_col(aes(fill=Status)) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
totals <- core_vs_variable %>% group_by(Species) %>% summarise(total = sum(Count))
totals
core
totals <- core_vs_variable %>% group_by(Species, Genome) %>% summarise(total = sum(Count))
totals
chisq.test(napus_a_vs_rapa_a_variable)
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)",
"B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(21729, 16844, 10447, 42089, 32145, 38542, 14667, 28464, 18233, 50973, 41938, 52169)
)
core_vs_variable
totals
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)",
"B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(21729, 16844, 10447, 42089, 32145, 38542, 14667, 28464, 18233, 50973, 41938, 52169),
Perc = c(21729/63818*100, 16844/48989*100, 10447/48989*100, 42089/63818*100, 32145/48989*100, 38542/48989*100
)
)
core_vs
core_vs_variable
total
totals
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. rapa", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)",
"B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)", "B. oleracea", "B. napus\n(with synthetics)", "B. napus\n(no synthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(21729, 16844, 10447, 42089, 32145, 38542, 14667, 28464, 18233, 50973, 41938, 52169),
Perc = c(21729/63818*100, 16844/48989*100, 10447/48989*100, 42089/63818*100, 32145/48989*100, 38542/48989*100,
14667/65640*100,28464/70402*100, 18233/70402*100, 50973/65640*100, 41938/70402*100, 52169/70402*100)
)
core_vs_variable
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Perc,
group = Status
)) +
ylab("Number of genes") +
xlab('Species') +
#geom_point(size = 3) +
#geom_line() +
geom_col(aes(fill=Status)) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Perc,
group = Status
)) +
ylab("Percentage core/variable") +
xlab('Species') +
#geom_point(size = 3) +
#geom_line() +
geom_col(aes(fill=Status)) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
save_plot(p, filename = 'Core_Variable_Genes_Per_A_C_Genome.png', base_aspect_ratio = 1.3, base_height = 5)
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Perc,
group = Status
)) +
ylab("Percentage core/variable") +
xlab('Species') +
#geom_point(size = 3) +
#geom_line() +
geom_col(aes(fill=Status)) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Perc,
group = Status
)) +
ylab("Percentage core/variable") +
xlab('Species') +
#geom_point(size = 3) +
#geom_line() +
geom_col(aes(fill=Status)) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no synthetics)",'B. napus\n(with synthetics)')),
y = Perc,
group = Status
)) +
ylab("Percentage core/variable") +
xlab('Species') +
#geom_point(size = 3) +
#geom_line() +
geom_col(aes(fill=Status)) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)", "B. rapa", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)",
"B. oleracea", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)", "B. oleracea", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(21729, 16844, 10447, 42089, 32145, 38542, 14667, 28464, 18233, 50973, 41938, 52169),
Perc = c(21729/63818*100, 16844/48989*100, 10447/48989*100, 42089/63818*100, 32145/48989*100, 38542/48989*100,
14667/65640*100,28464/70402*100, 18233/70402*100, 50973/65640*100, 41938/70402*100, 52169/70402*100)
)
library(tidyverse)
totals <- core_vs_variable %>% group_by(Species, Genome) %>% summarise(total = sum(Count))
totals
totals
core_vs_variable
library(ggplot2)
library(cowplot)
theme_set(theme_light())
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no syn-\nthetics)",'B. napus\n(with syn-\nthetics)')),
y = Perc,
group = Status
)) +
ylab("Percentage core/variable") +
xlab('Species') +
#geom_point(size = 3) +
#geom_line() +
geom_col(aes(fill=Status)) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
save_plot(p, filename = 'Core_Variable_Genes_Per_A_C_Genome.png', base_aspect_ratio = 1.3, base_height = 5)
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)", "B. rapa", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)",
"B. oleracea", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)", "B. oleracea", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(21729, 16844, 10447, 42089, 32145, 38542, 14667, 28464, 18233, 50973, 41938, 52169),
Perc = c(21729/63818*100, 16844/48989*100, 10447/48989*100, 42089/63818*100, 32145/48989*100, 38542/48989*100,
14667/65640*100,28464/70402*100, 18233/70402*100, 50973/65640*100, 41938/70402*100, 52169/70402*100)
)
core_vs_variable
totals
42089/63818*100
View(core_vs_variable)
core_vs_variable
34.3 - 21
40-25
napus_c_vs_oleracea_c_variable <- data.frame(
V1 = c(8093, 38916),
V2 = c(16199, 30810)
)
napus_c_vs_oleracea_c_variable
8093+38916
16199+30810
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)", "B. rapa", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)",
"B. oleracea", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)", "B. oleracea", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(21729, 16844, 10447, 42089, 32145, 38542, 14667, 28464, 18233, 50973, 41938, 52169),
Perc = c(21729/63818*100, 16844/48989*100, 10447/48989*100, 42089/63818*100, 32145/48989*100, 38542/48989*100,
14667/65640*100,28464/70402*100, 18233/70402*100, 50973/65640*100, 41938/70402*100, 52169/70402*100)
)
View(core_vs_variable)
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)", "B. rapa", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)",
"B. oleracea", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)", "B. oleracea", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(21729, 16844, 10447, 42089, 32145, 38542, 14667, 28464, 18233, 50973, 41938, 52169),
Perc = c(21729/63818*100, 16844/48989*100, 10447/48989*100, 42089/63818*100, 32145/48989*100, 38542/48989*100,
14667/65640*100,28464/70402*100, 18233/70402*100, 50973/65640*100, 41938/70402*100, 52169/70402*100)
)
library(tidyverse)
write_tsv(core_vs_variable, 'core_vs_variable.tsv')
#write_tsv(core_vs_variable, 'core_vs_variable.tsv')
core_vs_variable <- read_tsv('core_vs_variable.tsv')
View(core_vs_variable)
totals <- core_vs_variable %>% group_by(Species, Genome) %>% summarise(total = sum(Count))
totals
library(ggplot2)
library(cowplot)
theme_set(theme_light())
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no syn-\nthetics)",'B. napus\n(with syn-\nthetics)')),
y = Perc,
group = Status
)) +
ylab("Percentage core/variable") +
xlab('Species') +
#geom_point(size = 3) +
#geom_line() +
geom_col(aes(fill=Status)) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
core_vs_variable <- data.frame(stringsAsFactors=TRUE,
Status = c("Variable", "Variable", "Variable", "Core", "Core", "Core", "Variable",
"Variable", "Variable", "Core", "Core", "Core"),
Species = c("B. rapa", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)", "B. rapa", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)",
"B. oleracea", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)", "B. oleracea", "B. napus\n(with syn-\nthetics)", "B. napus\n(no syn-\nthetics)"),
Genome = c("A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "A-genome", "C-genome", "C-genome", "C-genome",
"C-genome", "C-genome", "C-genome"),
Count = c(21729, 16844, 10447, 42089, 32145, 38542, 14667, 28464, 18233, 50973, 41938, 52169),
Perc = c(21729/63818*100, 16844/48989*100, 10447/48989*100, 42089/63818*100, 32145/48989*100, 38542/48989*100,
14667/65640*100,28464/70402*100, 18233/70402*100, 50973/65640*100, 41938/70402*100, 52169/70402*100)
)
totals
#write_tsv(core_vs_variable, 'core_vs_variable.tsv')
core_vs_variable <- read_tsv('core_vs_variable.tsv')
core_vs_variable$Perc
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no syn-\nthetics)",'B. napus\n(with syn-\nthetics)')),
y = Perc,
group = Status
)) +
ylab("Percentage core/variable") +
xlab('Species') +
#geom_point(size = 3) +
#geom_line() +
geom_col(aes(fill=Status)) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
#write_tsv(core_vs_variable, 'core_vs_variable.tsv')
core_vs_variable <- read_tsv('core_vs_variable.tsv')
core_vs_variable$Perc
View(core_vs_variable)
#write_tsv(core_vs_variable, 'core_vs_variable.tsv')
core_vs_variable <- read_tsv('core_vs_variable.tsv')
core_vs_variable$Perc
totals <- core_vs_variable %>% group_by(Species, Genome) %>% summarise(total = sum(Count))
totals
core_vs_variable
theme_set(theme_light())
p <- ggplot(data = core_vs_variable, aes(
x = factor(Species, levels = c('B. rapa', 'B. oleracea', "B. napus\n(no syn-\nthetics)",'B. napus\n(with syn-\nthetics)')),
y = Perc,
group = Status
)) +
ylab("Percentage core/variable") +
xlab('Species') +
#geom_point(size = 3) +
#geom_line() +
geom_col(aes(fill=Status)) +
scale_color_brewer(palette='Dark2') +
facet_grid( ~ Genome, space = 'free', scale = 'free') +
theme(axis.text.x = element_text(face = "italic"))
p
save_plot(p, filename = 'Core_Variable_Genes_Per_A_C_Genome.png', base_aspect_ratio = 1.3, base_height = 5)
