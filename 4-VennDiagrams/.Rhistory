library(tidyverse)
library(tidyverse
library(tidyverse)
install.packages('VennDiagram')
library(VennDiagram)
makeVenn <- function(name) {
df <- read_tsv(name)
}
makeVenn <- function(name) {
df <- read_tsv(name)
head(df)
}
makeVenn('./NewPAV_Table.tsv)
makeVenn('./NewPAV_Table.tsv')
install.packages("vroom")
library(vroom)
install.packages('venneuler')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(venneuler)
vd <- venneuler(c(A=0.3, B=0.3, C=1.1, "A&B"=0.1, "A&C"=0.2, "B&C"=0.1 ,"A&B&C"=0.1))
vd
plot(vd)
vd <- venneuler(c("napus&oleracea&rapa"=123816, "napus&oleracea"=995, "napus&rapa"=8073, "oleracea&rapa"=0, napus=28, rapa=0, oleracea=0))
plot(vd)
?venneuler
vd <- venneuler(c("napus&oleracea&rapa"=123816, "napus&oleracea"=995, "napus&rapa"=8073, "oleracea&rapa"=0, napus=28, rapa=0, oleracea=0)>0)
plot(vd)
library(VennDiagram)
category = c('B. napus', 'B. rapa', 'B. oleracea))
area_napus = 123816 + 995 + 8073 + 28
area_rapa = 123816  + 8073
area_oleracea = 123816 + 995
napus_rapa= 8073
rapa_oleracea = 0
napus_oleracea= 995
napus_oleracea_rapa = 123816
draw.triple.venn(area_napus, area_rapa, area_oleracea, napus-rapa, rapa_oleracea, napus_oleracea, napus_oleracea_rapa,
category = c('B. napus', 'B. rapa', 'B. oleracea))
draw.triple.venn(area_napus, area_rapa, area_oleracea, napus-rapa, rapa_oleracea, napus_oleracea, napus_oleracea_rapa,
category = c('B. napus', 'B. rapa', 'B. oleracea'))
draw.triple.venn(area_napus, area_rapa, area_oleracea, napus_rapa, rapa_oleracea, napus_oleracea, napus_oleracea_rapa,
category = c('B. napus', 'B. rapa', 'B. oleracea'))
?draw.triple.venn
draw.triple.venn(area1=area_napus,
area2=area_rapa,
area3=area_oleracea,
n12=napus_rapa,
n23=rapa_oleracea,
n13=napus_oleracea,
n123=napus_oleracea_rapa,
category = c('B. napus', 'B. rapa', 'B. oleracea'))
df <- read_tsv('./NewPAV_Table.tsv_gene_names.txt', col_names=FALSE)
head(df)
napus_genes <- df %>% filter(X2 == 'in_napus') %>% select(X1)
head(napus_genes)
napus_genes <- df %>% filter(X2 == 'in_napus') %>% select(X1)
rapa_genes <- df %>% filter(X2 == 'in_rapa') %>% select(X1)
oleracea_genes <- df %>% filter(X2 == 'in_oleracea') %>% select(X1)
vd <- venn.diagram(
x = list(napus_genes , rapa_genes, oleracea_genes),
category.names = c("B. napus" , "B. rapa" , "B. oleracea"))
vd <- venn.diagram(
x = list(napus_genes , rapa_genes, oleracea_genes),
category.names = c("B. napus" , "B. rapa" , "B. oleracea"), filename = 'Napus_Venn.png')
install.packages('eulerr')
install.packages('eulerr')
install.package
library(eulerr)
library(eulerr)
vd <- venn(c("napus&oleracea&rapa"=123816, "napus&oleracea"=995, "napus&rapa"=8073, "oleracea&rapa"=0, napus=28, rapa=0, oleracea=0))
vd
plot(vd)
plot(vd, labels=c('A','b','c'))
plot(vd, labels=c(expression(italic('A')), 'b', 'c'))
plot(vd)
plot(vd, labels=c(expression(italic('B. napus')), 'b', 'c'))
plot(vd)
plot(vd, labels=c(expression(italic('B. napus')), 'b', 'c'))
plot(vd)
plot(vd, labels=c(expression(italic('B. napus')), 'b', 'c'))
plot(vd)
plot(vd, labels=c(expression(italic('B. napus')), 'b', 'c'))
plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
vd <- venn(c("napus&oleracea&rapa"=0, "napus&oleracea"=65610, "napus&rapa"=0, "oleracea&rapa"=0, napus=0, rapa=0, oleracea=30))
plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
vd <- venn(c("napus&oleracea&rapa"=62199, "napus&oleracea"=1, "napus&rapa"=1317, "oleracea&rapa"=25, napus=1, rapa=66, oleracea=3))
plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
vd <- venn(c("napus&oleracea&rapa"=123816, "napus&oleracea"=995, "napus&rapa"=8073, "oleracea&rapa"=0, napus=28, rapa=0, oleracea=0))
plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
ggsave('Napus_pangenome.png')
vd <- venn(c("napus&oleracea&rapa"=0, "napus&oleracea"=65610, "napus&rapa"=0, "oleracea&rapa"=0, napus=0, rapa=0, oleracea=30))
plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
ggsave('Oleracea_pangenome.png')
vd <- venn(c("napus&oleracea&rapa"=62199, "napus&oleracea"=1, "napus&rapa"=1317, "oleracea&rapa"=25, napus=1, rapa=66, oleracea=3))
plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
ggsave('Rapa_pangenome.png')
getwd()
ggsave('Oleracea_pangenome.png')
?ggsave
vd <- venn(c("napus&oleracea&rapa"=123816, "napus&oleracea"=995, "napus&rapa"=8073, "oleracea&rapa"=0, napus=28, rapa=0, oleracea=0))
plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
ggsave('Napus_pangenome.png')
a <- plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
ggsave('Napus_pangenome.png', plot=a)
a <- plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
vd <- venn(c("napus&oleracea&rapa"=0, "napus&oleracea"=65610, "napus&rapa"=0, "oleracea&rapa"=0, napus=0, rapa=0, oleracea=30))
ggsave('Oleracea_pangenome.png', plot=a)
vd <- venn(c("napus&oleracea&rapa"=123816, "napus&oleracea"=995, "napus&rapa"=8073, "oleracea&rapa"=0, napus=28, rapa=0, oleracea=0))
a <- plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
ggsave('Napus_pangenome.png', plot=a)
vd <- venn(c("napus&oleracea&rapa"=0, "napus&oleracea"=65610, "napus&rapa"=0, "oleracea&rapa"=0, napus=0, rapa=0, oleracea=30))
a <- plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
ggsave('Oleracea_pangenome.png', plot=a)
vd <- venn(c("napus&oleracea&rapa"=62199, "napus&oleracea"=1, "napus&rapa"=1317, "oleracea&rapa"=25, napus=1, rapa=66, oleracea=3))
a <- plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
ggsave('Rapa_pangenome.png', plot = a)
vd <- venn(c("napus&oleracea&rapa"=123816, "napus&oleracea"=995, "napus&rapa"=8073, "oleracea&rapa"=0, napus=28, rapa=0, oleracea=0))
a
a <- plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
vd <- venn(c("napus&oleracea&rapa"=123816, "napus&oleracea"=995, "napus&rapa"=8073, "oleracea&rapa"=0, napus=28, rapa=0, oleracea=0))
a <- plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
a
vd <- venn(c("napus&oleracea&rapa"=0, "napus&oleracea"=65610, "napus&rapa"=0, "oleracea&rapa"=0, napus=0, rapa=0, oleracea=30))
a
vd <- venn(c("napus&oleracea&rapa"=62199, "napus&oleracea"=1, "napus&rapa"=1317, "oleracea&rapa"=25, napus=1, rapa=66, oleracea=3))
a <- plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
a
vd <- venn(c("napus&oleracea&rapa"=0, "napus&oleracea"=65610, "napus&rapa"=0, "oleracea&rapa"=0, napus=0, rapa=0, oleracea=30))
a <- plot(vd, labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
a
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reticulate)
install.packages('reticulate')
library(reticulate)
library(reticulate)
library(tidyverse)
library(reticulate)
use_python('/usr/bin/python3')
version(knitr)
sessionInfo()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reticulate)
use_python('/usr/bin/python3')
py_discover_config()
use_python('/usr/bin/python3')
py_discover_config()
use_python('/usr/bin/python3', required=TRUE)
py_discover_config()
use_python('/usr/bin/python3', required=TRUE)
py_discover_config()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reticulate)
use_python('/usr/bin/python3', required=TRUE)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(reticulate)
use_python('/usr/bin/python3', required=TRUE)
library(tidyverse)
library(eulerr)
vd <- venn(c("napus&oleracea&rapa"=104465, "napus&oleracea"=684, "napus&rapa"=2512, "oleracea&rapa"=0, napus=955, rapa=0, oleracea=0))
napus <- plot(vd)
napus
napus <- plot(vd, labels = c(expression(italic('B. napus')), 'OLER', 'RAPA'))
plot
xyplot(1~1, xlim = c(-1.1, 2), ylim = c(-1.5, 1.1), asp = "iso",
xlab = NULL, ylab = NULL,
scales = list(draw = FALSE),
par.settings = list(axis.line = list(col = "transparent")),
panel = function() {
panel.polygon(seg, col = "steelblue1", alpha = 0.5,
border = "transparent")
grid::grid.circle(0, 0, r = 1, default.units = "native",
gp = gpar(fill = "transparent"))
grid::grid.circle(1.2, 0, r = 0.7, default.units = "native",
gp = gpar(fill = "transparent"))
pBrackets::grid.brackets(1.2, -1.2, 0, -1.2, h = 0.05)
pBrackets::grid.brackets(-1, 0, 0, 0, h = 0.05)
pBrackets::grid.brackets(1.2, 0, 1.9, 0, h = 0.05)
panel.lines(c(0, 0), c(0, -1.2), lty = 2, col = "grey65")
panel.lines(c(1.2, 1.2), c(0, -1.2), lty = 2, col = "grey65")
panel.text(0.6, unit(-1.3, "native"),
labels = expression(italic(d[ij])), pos = 1)
panel.text(ospot[1], ospot[2], labels = expression(italic(O[ij])))
panel.text(-0.5, 0.1, labels = expression(italic(r[i])), pos = 3,
default.units = "native")
panel.text(1.55, 0.1, labels = expression(italic(r[j])), pos = 3,
default.units = "native")
panel.points(c(0, 1.2), c(0, 0), pch = 21, col = 1, cex = 1,
fill = "white")
})
napus <- plot(vd, labels = c('B. napus', 'B.oleracea', 'B. rapa'))
napus
vd <- venn(c("napus&oleracea&rapa"=57941, "napus&oleracea"=0, "napus&rapa"=1198, "oleracea&rapa"=16, napus=0, rapa=771, oleracea=0))
rapa <- plot(vd, labels = c('B. napus', 'B.oleracea', 'B. rapa')#labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
rapa
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(eulerr)
vd <- venn(c("napus&oleracea&rapa"=104465, "napus&oleracea"=684, "napus&rapa"=2512, "oleracea&rapa"=0, napus=955, rapa=0, oleracea=0))
napus <- plot(vd, labels = c('B. napus', 'B.oleracea', 'B. rapa'))
#, labels=c(expression(italic('B. napus')), 'OLER', 'RAPA'))
#                expression(italic('B. napus')),
#                          expression(italic('B. oleracea')),
#                          expression(italic('B. rapa'))))
napus
ggsave('Napus_pangenome.png', plot=napus)
vd <- venn(c("napus&oleracea&rapa"=57717, "napus&oleracea"=226, "napus&rapa"=0, "oleracea&rapa"=12, napus=0, rapa=0, oleracea=360))
oleracea <- plot(vd, labels = c('B. napus', 'B.oleracea', 'B. rapa')) #labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
oleracea
ggsave('Oleracea_pangenome.png', plot=oleracea)
vd <- venn(c("napus&oleracea&rapa"=57941, "napus&oleracea"=0, "napus&rapa"=1198, "oleracea&rapa"=16, napus=0, rapa=771, oleracea=0))
rapa <- plot(vd, labels = c('B. napus', 'B.oleracea', 'B. rapa'))
#labels=c(expression(italic('B. napus')), expression(italic('B. oleracea')), expression(italic('B. rapa'))))
rapa
ggsave('Rapa_pangenome.png', plot = rapa)
grid <- plot_grid(napus, oleracea, rapa, labels = c('A', 'B', 'C'))
library(cowplot)
grid <- plot_grid(napus, oleracea, rapa, labels = c('A', 'B', 'C'))
ggsave('Napus_oleracea_rapa_grid.png', plot=grid)
library(cowplot)
grid <- plot_grid(oleracea, rapa, labels = c('B', 'C'))
plot_grid(napus, grid, labels = c('A', NULL))
ggsave('Napus_oleracea_rapa_grid.png', plot=grid)
plot_grid(napus, grid, labels = c('A', NULL), nrow=2)
plot_grid(grid, napus, labels = c('A', NULL), nrow=2)
grid <- plot_grid(oleracea, rapa, labels = c('A', 'B'))
plot_grid(grid, napus, labels = c('C', NULL), nrow=2)
plot_grid(grid, napus, labels = c('C', NULL), label_x = 0, label_y = 0, vjust = -0.5, nrow=2)
plot_grid(grid, napus, labels = c('C', NULL), label_x = 0, label_y = 0, vjust = -0.7, nrow=2)
plot_grid(grid, napus, labels = c('C', NULL), label_x = 0, label_y = -0.5, vjust = -0.5, nrow=2)
plot_grid(grid, napus, labels = c('C', NULL), label_x = 0, label_y = -0.3, vjust = -0.5, nrow=2)
plot_grid(grid, napus, labels = c('C', NULL), label_x = 0.3, label_y = -0.3, vjust = -0.5, nrow=2)
plot_grid(grid, napus, labels = c('C', NULL), label_x = 0.3, label_y = -0.2, vjust = -0.5, nrow=2)
plot_grid(grid, napus, labels = c('C', NULL), label_x = 0.3, label_y = -0.1, vjust = -0.5, nrow=2)
plot_grid(grid, napus, labels = c('C', NULL), label_x = 0.3, label_y = -0.15, vjust = -0.5, nrow=2)
plot_grid(grid, napus, labels = c('C', NULL), label_x = 0.25, label_y = -0.15, vjust = -0.5, nrow=2)
plot_grid(grid, napus, labels = c('C', NULL), label_x = 0.25, label_y = -0.2, vjust = -0.5, nrow=2)
grid <- plot_grid(oleracea, rapa, labels = c('A', 'B'))
grid <- plot_grid(grid, napus, labels = c('C', NULL), label_x = 0.25, label_y = -0.2, vjust = -0.5, nrow=2)
ggsave('Napus_oleracea_rapa_grid.png', plot=grid)
save_plot('Napus_oleracea_rapa_grid.png', plot=grid)
ggsave
ggsave('Napus_oleracea_rapa_grid.png', plot=grid)
?ggsave
ggsave('Napus_oleracea_rapa_grid.png', plot=grid, scale = 1.5)
ggsave('Napus_oleracea_rapa_grid.png', plot=grid, scale = 2)
